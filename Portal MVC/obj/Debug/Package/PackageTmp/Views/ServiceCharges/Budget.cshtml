@using Portal_MVC.Models
@using System.Globalization
@model Portal_MVC.Models.ServiceChargeBudgetViewModel



@if (Session["SelectedPropertyID"] == null || (int)Session["SelectedPropertyID"] == 0)
{
    ViewBag.Title = "Select Property - New Estates";
    <div class="container">
       @Html.Partial("_SelectProperty", Model)
        </div>
}
else
{
    
        ViewBag.Title = "Service Charge Budget - New Estates";
    
    if (Model.Estate.BudgetList.Count > 0)
    {
<div>
    <h3>Service Charge Budget</h3>
    <h4>@Model.Estate.EstateName</h4>

    <h5>@Model.Estate.BudgetList[0].SCStartDate - @Model.Estate.BudgetList[0].SCEndDate</h5>



    @foreach (var schedule in Model.Estate.Schedules)
    {
        Model.Estate.TotalBudget = 0;
        Model.Estate.TotalExp = 0;

        @Html.EJS().Grid("Grid").DataSource(Model.Estate.BudgetList).Columns(col =>
                {
                col.Field("SCHeading").HeaderText("Heading").Width("100").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Left).Add();
                col.Field("SCCoststr").HeaderText("Amount").Width("50").Add();
                col.Field("strApportionment").HeaderText("Apportionment").Width("50").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Right).Add();
                col.Field("strContribution").HeaderText("Contribution").Width("50").Add();
                col.Field("BudgetNotes").HeaderText("Notes").Width("120").TextAlign(Syncfusion.EJ2.Grids.TextAlign.Left).HideAtMedia("(min-width: 700px)").Add();
                }).AllowPaging(true).Render()


        @*<div class="panel GradientBackground col-md-12 col-lg-10 col-lg-offset-1">
            <h4>Schedule: @schedule</h4>
            <table class="table">
                <thead>
                    <tr>
                        <th>Cost Heading</th>
                        <th>Cost</th>
                        <th>Apportionment</th>
                        <th>Contribution</th>
                        <th>Comments</th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (Estates item in Model.Estate.BudgetList)
                    {
                        if (item.SCScheduleName == schedule && item.SCHeading != "Income" && item.SCHeading != "Roundings")
                        {
                            Model.Estate.TotalBudget = Model.Estate.TotalBudget + item.SCCost;
                            Model.Estate.TotalExp = Model.Estate.TotalExp + item.contribution;
                            //implement when do pie charts
                            //Model.Estate.PieChartData.Rows.Add();
                            //int rowIndex = Model.Estate.PieChartData.Rows.Count - 1;
                            //Model.Estate.PieChartData.Rows[rowIndex][0] = item.SCHeading;
                            //Model.Estate.PieChartData.Rows[rowIndex][1] = item.SCCost;

                            <tr>
                                <td>
                                    <p>@item.SCHeading</p>
                                </td>

                                <td>
                                    <p>@item.SCCoststr</p>
                                </td>
                                <td>
                                    @if (@item.strApportionment == "0%")
                                    {
                                        <p>Not Set</p>
                                    }
                                    else
                                    {
                                        <div style="text-align: center;">
                                            <p>@item.strApportionment</p>
                                        </div>
                                    }

                                </td>
                                <td>
                                    @if (@item.strContribution == "£0.00")
                                    {
                                        <p>Not Set</p>
                                    }
                                    else
                                    {
                                        <p>@item.strContribution</p>
                                    }

                                </td>
                                <td class="MobileCollapse">
                                    @if (string.IsNullOrWhiteSpace(@item.BudgetNotes))
                                    {
                                        <p></p>
                                    }
                                    else
                                    {
                                        <p>@item.BudgetNotes</p>
                                    }

                                </td>
                            </tr>
                        }
                    }
                </tbody>
                <tfoot>

                    <tr class="TotalsRow">
                        <td><p>Totals</p></td>
                        <td><p>@Controls.CurrencyString(Model.Estate.TotalBudget)</p></td>
                        <td style="visibility: hidden">Placeholder</td>
                        <td><p>@Controls.CurrencyString(Model.Estate.TotalExp)</p></td>
                        <td style="visibility: hidden">Placeholder</td>

                    </tr>
                </tfoot>
            </table>
        </div>*@






    }

</div>
    } else
    {
        <div class="container">
            <h5>Currently there are no budgets for this property</h5>
        </div>
    }
}

<script>

        // get the grid element instances 
      // document.getElementById('Grid').style.height = "1000px";
       
  
  
    
</script>





